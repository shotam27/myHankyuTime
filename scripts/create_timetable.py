#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
時刻表データを手動で整形してCSV/JSON形式に変換
"""

import json
import csv

# 時刻表データ（大阪梅田方面のみ）
timetable_data = [
    ("05:16", "普通", "大阪梅田"),
    ("05:35", "普通", "大阪梅田"),
    ("05:54", "普通", "大阪梅田"),
    ("06:12", "普通", "大阪梅田"),
    ("06:18", "普通", "大阪梅田"),
    ("06:22", "普通", "大阪梅田"),
    ("06:33", "普通", "大阪梅田"),
    ("06:43", "普通", "大阪梅田"),
    ("06:47", "普通", "大阪梅田"),
    ("06:57", "普通", "大阪梅田"),
    ("07:06", "普通", "大阪梅田"),
    ("07:17", "普通", "大阪梅田"),
    ("07:28", "普通", "大阪梅田"),
    ("07:45", "普通", "大阪梅田"),
    ("07:48", "普通", "大阪梅田"),
    ("08:03", "普通", "大阪梅田"),
    ("08:21", "普通", "大阪梅田"),
    ("08:32", "普通", "大阪梅田"),
    ("08:49", "普通", "大阪梅田"),
    ("09:09", "普通", "大阪梅田"),
    ("09:29", "普通", "大阪梅田"),
    ("09:50", "普通", "大阪梅田"),
    ("10:11", "普通", "大阪梅田"),
    ("10:31", "普通", "大阪梅田"),
    ("10:51", "普通", "大阪梅田"),
    ("11:11", "普通", "大阪梅田"),
    ("11:31", "普通", "大阪梅田"),
    ("11:51", "普通", "大阪梅田"),
    ("12:11", "普通", "大阪梅田"),
    ("12:31", "普通", "大阪梅田"),
    ("12:51", "普通", "大阪梅田"),
    ("13:11", "普通", "大阪梅田"),
    ("13:31", "普通", "大阪梅田"),
    ("13:51", "普通", "大阪梅田"),
    ("14:11", "普通", "大阪梅田"),
    ("14:31", "普通", "大阪梅田"),
    ("14:51", "普通", "大阪梅田"),
    ("15:11", "普通", "大阪梅田"),
    ("15:31", "普通", "大阪梅田"),
    ("15:50", "普通", "大阪梅田"),
    ("16:10", "普通", "大阪梅田"),
    ("16:30", "普通", "大阪梅田"),
    ("16:50", "普通", "大阪梅田"),
    ("17:13", "普通", "大阪梅田"),
    ("17:24", "普通", "大阪梅田"),
    ("17:33", "普通", "大阪梅田"),
    ("17:43", "普通", "大阪梅田"),
    ("17:53", "普通", "大阪梅田"),
    ("18:04", "普通", "大阪梅田"),
    ("18:14", "普通", "大阪梅田"),
    ("18:24", "普通", "大阪梅田"),
    ("18:34", "普通", "大阪梅田"),
    ("18:44", "普通", "大阪梅田"),
    ("18:54", "普通", "大阪梅田"),
    ("19:04", "普通", "大阪梅田"),
    ("19:15", "普通", "大阪梅田"),
    ("19:23", "普通", "大阪梅田"),
    ("19:33", "普通", "大阪梅田"),
    ("19:44", "普通", "大阪梅田"),
    ("19:54", "普通", "大阪梅田"),
    ("20:04", "普通", "大阪梅田"),
    ("20:08", "普通", "大阪梅田"),
    ("20:14", "普通", "大阪梅田"),
    ("20:24", "普通", "大阪梅田"),
    ("20:34", "普通", "大阪梅田"),
    ("20:45", "普通", "大阪梅田"),
    ("20:55", "普通", "大阪梅田"),
    ("21:04", "普通", "大阪梅田"),
    ("21:08", "普通", "大阪梅田"),
    ("21:19", "普通", "大阪梅田"),
    ("21:30", "普通", "大阪梅田"),
    ("21:43", "普通", "大阪梅田"),
    ("21:55", "普通", "大阪梅田"),
    ("22:08", "普通", "大阪梅田"),
    ("22:21", "普通", "大阪梅田"),
    ("22:31", "普通", "大阪梅田"),
    ("22:46", "普通", "大阪梅田"),
    ("23:00", "普通", "大阪梅田"),
    ("23:14", "普通", "大阪梅田"),
    ("23:29", "普通", "大阪梅田"),
    ("23:44", "普通", "大阪梅田"),
]

def main():
    # JSONデータ作成
    trains = []
    for time_str, train_type, destination in timetable_data:
        hour, minute = time_str.split(':')
        trains.append({
            'time': time_str,
            'hour': hour,
            'minute': minute,
            'type': train_type,
            'destination': destination
        })
    
    json_output = {
        'station': '総持寺',
        'direction': '大阪梅田',
        'day_type': '平日',
        'total_trains': len(trains),
        'trains': trains
    }
    
    # JSON保存
    with open('timetable_weekday.json', 'w', encoding='utf-8') as f:
        json.dump(json_output, f, ensure_ascii=False, indent=2)
    
    print(f'✓ JSON保存完了: timetable_weekday.json ({len(trains)}本)')
    
    # CSV保存
    with open('timetable_weekday.csv', 'w', encoding='utf-8-sig', newline='') as f:
        writer = csv.writer(f)
        writer.writerow(['時刻', '種別', '行き先'])
        for time_str, train_type, destination in timetable_data:
            writer.writerow([time_str, train_type, destination])
    
    print(f'✓ CSV保存完了: timetable_weekday.csv ({len(timetable_data)}本)')
    
    # サンプル表示
    print('\n【最初の5本】')
    for time_str, train_type, destination in timetable_data[:5]:
        print(f"  {time_str} [{train_type}] {destination}")
    
    print('\n【最後の5本】')
    for time_str, train_type, destination in timetable_data[-5:]:
        print(f"  {time_str} [{train_type}] {destination}")
    
    print(f'\n合計: {len(timetable_data)}本の電車（大阪梅田方面・平日）')

if __name__ == '__main__':
    main()
